(()=>{"use strict";var e={d:(a,t)=>{for(var o in t)e.o(t,o)&&!e.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:t[o]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)},a={};e.d(a,{QR:()=>n,Di:()=>t,PP:()=>l,S7:()=>o,b4:()=>r,SX:()=>s,KA:()=>i,rd:()=>f,OB:()=>p,Kr:()=>h,vb:()=>u,an:()=>b});class t extends Error{constructor(){super(...arguments),this.name="ApiBaseError"}}class o extends t{constructor(e,a="ApiDomError",t){super(e,t),this.name=a}}class r extends t{constructor(e,a,t){super(e,t),this.status=a,this.name="ApiHttpStatusError"}}class n extends r{constructor(e,a){super(e,401,a),this.name="ApiAuthError"}}class s extends t{constructor(){super(...arguments),this.name="ApiResponseError"}}class i extends s{constructor(e,a,t){super(e,t),this.error=a,this.name="ApiStreamError"}}class l extends s{constructor(e,a,t){super(e,t),this.responseHeader=a,this.name="ApiCommonStatusError"}}class c extends TransformStream{#e="";#a=!1;#t=!1;#o=e=>e;constructor(e){super({transform:(e,a)=>this.#r(e,a),flush:e=>this.#r("\r\n",e)}),this.#a=e?.allowCR??!1,this.#t=e?.returnEmptyLines??!1,this.#o=e?.mapperFun??this.#o}#r(e,a){for(e=this.#e+e;;){const t=e.indexOf("\n");if(this.#a){const o=e.indexOf("\r");if(-1!==o&&o!==e.length-1&&(-1===t||t-1>o)){const t=this.#o(e.slice(0,crOrLfIndex));(this.#t||t)&&a.enqueue(t),e=e.slice(o+1);continue}}if(-1===t)break;{let o=t;"\r"===e[t-1]&&o--;const r=this.#o(e.slice(0,o));(this.#t||r)&&a.enqueue(r),e=e.slice(t+1)}}this.#e=e}}const d=async e=>{const a={},t={method:e.method,headers:a};let s;void 0!==e.payload&&(t.body=JSON.stringify(e.payload),a["Content-Type"]="application/json"),void 0!==e.authInfo&&(a["Grpc-Metadata-username"]=e.authInfo.username,a["Grpc-Metadata-token"]=e.authInfo.token),void 0!==e.headers&&Object.assign(a,e.headers),void 0!==e.abortSignal&&(t.signal=e.abortSignal);try{s=await fetch(e.baseUrl+e.path,t)}catch(e){if(e instanceof DOMException)throw new o(e.message,e.name);throw new o("unexpected fetch result")}if(401===s.status)throw new n("failed to authenticate: token might be invalid");if(!s.ok)throw new r("failed to fetch response: invalid http status code",s.status);return s},h=async e=>{const a=await d(e);try{return await a.json()}catch(e){throw new s("failed to parse as json")}},u=async function*(e){const a=(await d(e)).body.pipeThrough(new TextDecoderStream).pipeThrough(new c).getReader();for(;;){const t=await a.read();if(t.done)break;let o;try{o=JSON.parse(t.value)}catch(e){throw new s("failed to parse as json")}if(void 0!==o.error)throw new i("response has an error",o.error);yield o}},f=async e=>{const a=await h(e);let t;try{t=a.responseHeader.status}catch(e){throw new s("failed to get resp.responseHeader.status")}if(0!==t)throw new l(`invalid status: ${t}`,a.responseHeader);return a},p=async function*(e){for await(const a of u(e)){let t;try{t=a.result.responseHeader.status}catch(e){throw new s("failed to get chunk.result.responseHeader.status")}if(0!==t)throw new l(`invalid status: ${t}`,a.result.responseHeader);yield a}},b=async e=>{const a=[];for await(const t of e)a.push(t);return a};var y=a.QR,S=a.SX,m=a.rd,w=a.OB,v=a.Kr,I={d:(e,a)=>{for(var t in a)I.o(a,t)&&!I.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)},g={};I.d(g,{FC:()=>E,a$:()=>x,oq:()=>J,Y8:()=>C,C3:()=>O,DB:()=>_,Pv:()=>P,pK:()=>T,l9:()=>R});const U=(A={fetchJson:()=>m,fetchJsonStream:()=>w},k={},I.d(k,A),k),_=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,U.fetchJsonStream)({method:"POST",baseUrl:e,path:"/area_service/blocked_areas_list",authInfo:a,payload:t,abortSignal:o}))yield r},O=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>await(0,U.fetchJson)({method:"GET",baseUrl:e,path:`/area_service/blocked_areas/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}),E=async({baseUrl:e,authInfo:a,payload:t,abortSignal:o})=>await(0,U.fetchJson)({method:"POST",baseUrl:e,path:"/area_service/blocked_areas",authInfo:a,payload:t,abortSignal:o}),J=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>{await(0,U.fetchJson)({method:"DELETE",baseUrl:e,path:`/area_service/blocked_areas/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o})},R=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,U.fetchJsonStream)({method:"POST",baseUrl:e,path:"/area_service/blocked_areas_events",authInfo:a,payload:t,abortSignal:o}))yield r},T=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,U.fetchJsonStream)({method:"POST",baseUrl:e,path:"/area_service/reserved_areas_list",authInfo:a,payload:t,abortSignal:o}))yield r},P=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>await(0,U.fetchJson)({method:"GET",baseUrl:e,path:`/area_service/reserved_areas/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}),x=async({baseUrl:e,authInfo:a,payload:t,abortSignal:o})=>await(0,U.fetchJson)({method:"POST",baseUrl:e,path:"/area_service/reserved_areas",authInfo:a,payload:t,abortSignal:o}),C=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>{await(0,U.fetchJson)({method:"DELETE",baseUrl:e,path:`/area_service/reserved_areas/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o})};var A,k,j=g.DB,$={d:(e,a)=>{for(var t in a)$.o(a,t)&&!$.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)},D={};$.d(D,{x:()=>G});const q=(L={ApiAuthError:()=>y,fetchRawJson:()=>v},B={},$.d(B,L),B),G=async({baseUrl:e,userId:a,password:t,abortSignal:o})=>{const r=await(0,q.fetchRawJson)({method:"POST",baseUrl:e,path:"/common_service/login",payload:{UserID:a,Password:t},abortSignal:o});if("Complete"!==r.Result)throw new q.ApiAuthError("failed to authenticate");return{username:a,token:r.Token}};var L,B,H=D.x,K={d:(e,a)=>{for(var t in a)K.o(a,t)&&!K.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)},N={};K.d(N,{RC:()=>X,Im:()=>V,h4:()=>se,ot:()=>ne,pC:()=>Y,pJ:()=>W,nL:()=>te,F7:()=>oe,Zo:()=>Q,dt:()=>M,bw:()=>z,cs:()=>Z,CI:()=>re,xO:()=>ae,IO:()=>ee});const F=(ie={ApiResponseError:()=>S,fetchJson:()=>m,fetchJsonStream:()=>w,fetchRawJson:()=>v},le={},K.d(le,ie),le),M=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/barriers_list",authInfo:a,payload:t,abortSignal:o}))yield r},Q=async function*({baseUrl:e,authInfo:a,id:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"GET",baseUrl:e,path:`/route_service/barriers/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}))yield r},X=async({baseUrl:e,authInfo:a,payload:t,abortSignal:o})=>{const r=await(0,F.fetchRawJson)({method:"POST",baseUrl:e,path:"/route_service/barriers",authInfo:a,payload:t,abortSignal:o});if("0"===r.id)throw new F.ApiResponseError("failed to create: returned id is 0");return r},Y=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>{await(0,F.fetchJson)({method:"DELETE",baseUrl:e,path:`/route_service/barriers/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o})},Z=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/private_barriers_list",authInfo:a,payload:t,abortSignal:o}))yield r},z=async function*({baseUrl:e,authInfo:a,id:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"GET",baseUrl:e,path:`/route_service/private_barriers/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}))yield r},V=async({baseUrl:e,authInfo:a,payload:t,abortSignal:o})=>{const r=await(0,F.fetchRawJson)({method:"POST",baseUrl:e,path:"/route_service/private_barriers",authInfo:a,payload:t,abortSignal:o});if("0"===r.id)throw new F.ApiResponseError("failed to create: returned id is 0");return r},W=async({baseUrl:e,authInfo:a,id:t,abortSignal:o})=>{await(0,F.fetchJson)({method:"DELETE",baseUrl:e,path:`/route_service/temporary_barriers/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o})},ee=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/reserved_routes_list",authInfo:a,payload:t,abortSignal:o}))yield r},ae=async({baseUrl:e,authInfo:a,reservedRouteId:t,abortSignal:o})=>await(0,F.fetchJson)({method:"GET",baseUrl:e,path:`/route_service/reserved_routes/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}),te=async({baseUrl:e,authInfo:a,reservedRouteId:t,abortSignal:o})=>{await(0,F.fetchJson)({method:"DELETE",baseUrl:e,path:`/route_service/reserved_routes/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o})},oe=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/aircrafts_list",authInfo:a,payload:t,abortSignal:o}))yield r},re=async function*({baseUrl:e,authInfo:a,aircraftId:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"GET",baseUrl:e,path:`/route_service/reserved_id_list/${encodeURIComponent(t)}`,authInfo:a,abortSignal:o}))yield r},ne=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/routes",authInfo:a,payload:t,abortSignal:o}))yield r},se=async function*({baseUrl:e,authInfo:a,payload:t,abortSignal:o}){for await(const r of(0,F.fetchJsonStream)({method:"POST",baseUrl:e,path:"/route_service/reserved_routes",authInfo:a,payload:t,abortSignal:o}))yield r};var ie,le,ce=N.xO;const de="https://trjxdev.trajectory.jp";let he=null;window.execLogin=async()=>{const e=document.querySelector("#login-userId").value,a=document.querySelector("#login-password").value,t=document.querySelector("#login-result");try{t.value="読み込み中",he=await H({baseUrl:de,userId:e,password:a}),t.value=`認証成功: ${he.token}`}catch(e){t.value="エラー: 認証失敗"}},window.execGetReservedRoute=async()=>{const e=document.querySelector("#getReservedRoute-id").value,a=document.querySelector("#getReservedRoute-result");if(null!==he)try{a.value="読み込み中";const t=await ce({baseUrl:de,authInfo:he,reservedRouteId:e}),o=JSON.stringify(t,null,2);a.value=o}catch(e){a.value=e instanceof y?"エラー: トークン期限切れ":"エラー: 呼び出し失敗"}else a.value="エラー: ログインしてください"},window.execGetBlockedAreas=async()=>{const e=document.querySelector("#getBlockedAreas-spatialId").value,a=document.querySelector("#getBlockedAreas-result");if(null===he)return void(a.value="エラー: ログインしてください");const t={boundary:[{ID:e}],hasSpatialId:!0,startTime:"0",endTime:"0"},o=[];try{a.value="読み込み中";for await(const e of j({baseUrl:de,authInfo:he,payload:t})){o.push(e);const t=JSON.stringify(o,null,2);a.value=t}}catch(e){a.value=e instanceof y?"エラー: トークン期限切れ":"エラー: 呼び出し失敗"}}})();
//# sourceMappingURL=index.bundle.js.map